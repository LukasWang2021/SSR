C1 = cos(q1);
    S1 = sin(q1);
    C2 = cos(q2);
    S2 = sin(q2);
    C3 = cos(q3);
    S3 = sin(q3);
    C4 = cos(q4);
    S4 = sin(q4);
    C5 = cos(q5);
    S5 = sin(q5);
    C6 = cos(q6);
    S6 = sin(q6);

    
    //辨识矩阵
    DV61 = dq1.^2;
    W12 = S2.*dq1;
    W22 = C2.*dq1;
    WP12 = S2.*ddq1 + W22.*dq2;
    WP22 = C2.*ddq1 - W12.*dq2;

    DV22 = W12.*W22;
    DV32 = W12.*dq2;
    DV42 = W22.^2;
    DV52 = W22.*dq2;
    DV62 = dq2.^2;
    U112 = -DV42 - DV62;
    U212 = DV22 + ddq2;
    U312 = DV32 - WP22;

    U322 = DV52 + WP12;

    VSP12 = -DV61.*a2;
    VSP22 = a2.*ddq1;
    VP12 = C2.*VSP12 - G.*S2;
    VP22 = -C2.*G - S2.*VSP12;
    W13 = C3.*W12 + S3.*W22;
    W23 = C3.*W22 - S3.*W12;
    W33 = dq2 + dq3;
    WP13 = C3.*WP12 + S3.*WP22 + W23.*dq3;
    WP23 = C3.*WP22 - S3.*WP12 - W13.*dq3;
    WP33 = ddq2 + ddq3;
    DV13 = W13.^2;
    DV23 = W13.*W23;
    DV33 = W13.*W33;
    DV43 = W23.^2;
    DV53 = W23.*W33;
    DV63 = W33.^2;
    U113 = -DV43 - DV63;
    U213 = DV23 + WP33;
    U313 = DV33 - WP23;
    U123 = DV23 - WP33;
    U223 = -DV13 - DV63;
    U323 = DV53 + WP13;

    VSP13 = U112.*a3 + VP12;
    VSP23 = U212.*a3 + VP22;
    VSP33 = U312.*a3 - VSP22;
    VP13 = C3.*VSP13 + S3.*VSP23;
    VP23 = C3.*VSP23 - S3.*VSP13;
    W14 = C4.*W13 + S4.*W33;
    W24 = C4.*W33 - S4.*W13;
    W34 = -W23 + dq4;
    WP14 = C4.*WP13 + S4.*WP33 + W24.*dq4;
    WP24 = C4.*WP33 - S4.*WP13 - W14.*dq4;
    WP34 = -WP23 + ddq4;
    DV14 = W14.^2;
    DV24 = W14.*W24;
    DV34 = W14.*W34;
    DV44 = W24.^2;
    DV54 = W24.*W34;
    DV64 = W34.^2;
    U114 = -DV44 - DV64;
    U214 = DV24 + WP34;
    U314 = DV34 - WP24;
    U124 = DV24 - WP34;
    U224 = -DV14 - DV64;
    U324 = DV54 + WP14;

    VSP14 = U113.*a4 - U123.*d4 + VP13;
    VSP24 = U213.*a4 - U223.*d4 + VP23;
    VSP34 = U313.*a4 - U323.*d4 + VSP33;
    VP14 = C4.*VSP14 + S4.*VSP34;
    VP24 = C4.*VSP34 - S4.*VSP14;
    W15 = C5.*W14 - S5.*W34;
    W25 = -C5.*W34 - S5.*W14;
    W35 = W24 + dq5;
    WP15 = C5.*WP14 - S5.*WP34 + W25.*dq5;
    WP25 = -C5.*WP34 - S5.*WP14 - W15.*dq5;
    WP35 = WP24 + ddq5;
    DV15 = W15.^2;
    DV25 = W15.*W25;
    DV35 = W15.*W35;
    DV45 = W25.^2;
    DV55 = W25.*W35;
    DV65 = W35.^2;
    U115 = -DV45 - DV65;
    U215 = DV25 + WP35;
    U315 = DV35 - WP25;
    U125 = DV25 - WP35;
    U225 = -DV15 - DV65;
    U325 = DV55 + WP15;

    VP15 = C5.*VP14 + S5.*VSP24;
    VP25 = C5.*VSP24 - S5.*VP14;
    W16 = C6.*W15 + S6.*W35;
    W26 = C6.*W35 - S6.*W15;
    W36 = -W25 + dq6;
    WP16 = C6.*WP15 + S6.*WP35 + W26.*dq6;
    WP26 = C6.*WP35 - S6.*WP15 - W16.*dq6;
    WP36 = -WP25 + ddq6;
    DV16 = W16.^2;
    DV26 = W16.*W26;
    DV36 = W16.*W36;
    DV46 = W26.^2;
    DV56 = W26.*W36;
    DV66 = W36.^2;
    U116 = -DV46 - DV66;
    U216 = DV26 + WP36;
    U316 = DV36 - WP26;
    U126 = DV26 - WP36;
    U226 = -DV16 - DV66;
    U326 = DV56 + WP16;

    VSP16 = -U125.*d6 + VP15;
    VSP26 = -U225.*d6 + VP25;
    VSP36 = -U325.*d6 + VP24;
    VP16 = C6.*VSP16 + S6.*VSP36;
    VP26 = C6.*VSP36 - S6.*VSP16;

    DG1ZZ1 = ddq1;

    DG1FS1 = sign(dq1);
    DG1FV1 = dq1;

    N13XX2 = C2.*DV32 + S2.*WP12;

    DG1XX2 = N13XX2;
    DG2XX2 = -DV22;
    No21XY2 = -W12.*dq2 + WP22;
    No22XY2 = W22.*dq2 + WP12;
    No23XY2 = W12.^2 - W22.^2;

    N13XY2 = C2.*No22XY2 + No21XY2.*S2;

    DG1XY2 = N13XY2;
    DG2XY2 = No23XY2;
    No21XZ2 = W12.*W22 + ddq2;
    No22XZ2 = -W12.^2 + dq2.^2;
    No23XZ2 = -W22.*dq2 + WP12;

    N13XZ2 = C2.*No22XZ2 + No21XZ2.*S2;

    DG1XZ2 = N13XZ2;
    DG2XZ2 = No23XZ2;

    No21YZ2 = W22.^2 - dq2.^2;
    No22YZ2 = -W12.*W22 + ddq2;
    No23YZ2 = W12.*dq2 + WP22;

    N13YZ2 = C2.*No22YZ2 + No21YZ2.*S2;

    DG1YZ2 = N13YZ2;
    DG2YZ2 = No23YZ2;

    N13ZZ2 = -C2.*DV32 + DV52.*S2;

    DG1ZZ2 = N13ZZ2;
    DG2ZZ2 = ddq2;

    N13MX2 = C2.*VSP22 - U312.*a2;

    DG1MX2 = N13MX2;
    DG2MX2 = VP22;

    N13MY2 = -S2.*VSP22 - U322.*a2;

    DG1MY2 = N13MY2;
    DG2MY2 = -VP12;

    DG2FS2 = sign(dq2);
    DG2FV2 = dq2;
    N21XX3 = C3.*WP13 - DV33.*S3;
    N22XX3 = C3.*DV33 + S3.*WP13;

    N13XX3 = C2.*N22XX3 + N21XX3.*S2;

    DG1XX3 = N13XX3;
    DG2XX3 = -DV23;
    DG3XX3 = -DV23;
    No31XY3 = -W13.*W33 + WP23;
    No32XY3 = W23.*W33 + WP13;
    No33XY3 = W13.^2 - W23.^2;
    N21XY3 = C3.*No31XY3 - No32XY3.*S3;
    N22XY3 = C3.*No32XY3 + No31XY3.*S3;

    N13XY3 = C2.*N22XY3 + N21XY3.*S2;

    DG1XY3 = N13XY3;
    DG2XY3 = No33XY3;
    DG3XY3 = No33XY3;
    No31XZ3 = W13.*W23 + WP33;
    No32XZ3 = -W13.^2 + W33.^2;
    No33XZ3 = -W23.*W33 + WP13;
    N21XZ3 = C3.*No31XZ3 - No32XZ3.*S3;
    N22XZ3 = C3.*No32XZ3 + No31XZ3.*S3;

    N13XZ3 = C2.*N22XZ3 + N21XZ3.*S2;

    DG1XZ3 = N13XZ3;
    DG2XZ3 = No33XZ3;
    DG3XZ3 = No33XZ3;

    No31YZ3 = W23.^2 - W33.^2;
    No32YZ3 = -W13.*W23 + WP33;
    No33YZ3 = W13.*W33 + WP23;
    N21YZ3 = C3.*No31YZ3 - No32YZ3.*S3;
    N22YZ3 = C3.*No32YZ3 + No31YZ3.*S3;

    N13YZ3 = C2.*N22YZ3 + N21YZ3.*S2;

    DG1YZ3 = N13YZ3;
    DG2YZ3 = No33YZ3;
    DG3YZ3 = No33YZ3;
    N21ZZ3 = C3.*DV53 + DV33.*S3;
    N22ZZ3 = -C3.*DV33 + DV53.*S3;

    N13ZZ3 = C2.*N22ZZ3 + N21ZZ3.*S2;

    DG1ZZ3 = N13ZZ3;
    DG2ZZ3 = WP33;
    DG3ZZ3 = WP33;

    FDI32MX3 = C3.*U213 + S3.*U113;
    N21MX3 = S3.*VSP33;
    N22MX3 = -C3.*VSP33 - U313.*a3;
    N23MX3 = FDI32MX3.*a3 + VP23;

    N13MX3 = C2.*N22MX3 + N21MX3.*S2 - U313.*a2;

    DG1MX3 = N13MX3;
    DG2MX3 = N23MX3;
    DG3MX3 = VP23;

    FDI32MY3 = C3.*U223 + S3.*U123;
    N21MY3 = C3.*VSP33;
    N22MY3 = S3.*VSP33 - U323.*a3;
    N23MY3 = FDI32MY3.*a3 - VP13;

    N13MY3 = C2.*N22MY3 + N21MY3.*S2 - U323.*a2;

    DG1MY3 = N13MY3;
    DG2MY3 = N23MY3;
    DG3MY3 = -VP13;

    DG3Im3 = ddq3;
    DG3FS3 = sign(dq3);
    DG3FV3 = dq3;
    N31XX4 = C4.*WP14 - DV34.*S4;
    N33XX4 = C4.*DV34 + S4.*WP14;
    N21XX4 = C3.*N31XX4 - DV24.*S3;
    N22XX4 = C3.*DV24 + N31XX4.*S3;

    N13XX4 = C2.*N22XX4 + N21XX4.*S2;

    DG1XX4 = N13XX4;
    DG2XX4 = N33XX4;
    DG3XX4 = N33XX4;
    DG4XX4 = -DV24;
    No41XY4 = -W14.*W34 + WP24;
    No42XY4 = W24.*W34 + WP14;
    No43XY4 = W14.^2 - W24.^2;
    N31XY4 = C4.*No41XY4 - No42XY4.*S4;
    N33XY4 = C4.*No42XY4 + No41XY4.*S4;
    N21XY4 = C3.*N31XY4 + No43XY4.*S3;
    N22XY4 = -C3.*No43XY4 + N31XY4.*S3;

    N13XY4 = C2.*N22XY4 + N21XY4.*S2;

    DG1XY4 = N13XY4;
    DG2XY4 = N33XY4;
    DG3XY4 = N33XY4;
    DG4XY4 = No43XY4;
    No41XZ4 = W14.*W24 + WP34;
    No42XZ4 = -W14.^2 + W34.^2;
    No43XZ4 = -W24.*W34 + WP14;
    N31XZ4 = C4.*No41XZ4 - No42XZ4.*S4;
    N33XZ4 = C4.*No42XZ4 + No41XZ4.*S4;
    N21XZ4 = C3.*N31XZ4 + No43XZ4.*S3;
    N22XZ4 = -C3.*No43XZ4 + N31XZ4.*S3;

    N13XZ4 = C2.*N22XZ4 + N21XZ4.*S2;


    DG1XZ4 = N13XZ4;
    DG2XZ4 = N33XZ4;
    DG3XZ4 = N33XZ4;
    DG4XZ4 = No43XZ4;

    No41YZ4 = W24.^2 - W34.^2;
    No42YZ4 = -W14.*W24 + WP34;
    No43YZ4 = W14.*W34 + WP24;
    N31YZ4 = C4.*No41YZ4 - No42YZ4.*S4;
    N33YZ4 = C4.*No42YZ4 + No41YZ4.*S4;
    N21YZ4 = C3.*N31YZ4 + No43YZ4.*S3;
    N22YZ4 = -C3.*No43YZ4 + N31YZ4.*S3;

    N13YZ4 = C2.*N22YZ4 + N21YZ4.*S2;

    DG1YZ4 = N13YZ4;
    DG2YZ4 = N33YZ4;
    DG3YZ4 = N33YZ4;
    DG4YZ4 = No43YZ4;
    N31ZZ4 = C4.*DV54 + DV34.*S4;
    N33ZZ4 = -C4.*DV34 + DV54.*S4;
    N21ZZ4 = C3.*N31ZZ4 + S3.*WP34;
    N22ZZ4 = -C3.*WP34 + N31ZZ4.*S3;

    N13ZZ4 = C2.*N22ZZ4 + N21ZZ4.*S2;

    DG1ZZ4 = N13ZZ4;
    DG2ZZ4 = N33ZZ4;
    DG3ZZ4 = N33ZZ4;
    DG4ZZ4 = WP34;
    FDI41MX4 = C4.*U114 - S4.*U214;
    FDI43MX4 = C4.*U214 + S4.*U114;
    N31MX4 = -FDI43MX4.*d4 - S4.*VSP24;
    N32MX4 = -FDI43MX4.*a4 - VP24;
    N33MX4 = C4.*VSP24 + FDI41MX4.*d4 - U314.*a4;

    FDI32MX4 = -C3.*U314 + FDI41MX4.*S3;
    N21MX4 = C3.*N31MX4 - N32MX4.*S3;
    N22MX4 = C3.*N32MX4 - FDI43MX4.*a3 + N31MX4.*S3;
    N23MX4 = FDI32MX4.*a3 + N33MX4;

    N13MX4 = C2.*N22MX4 - FDI43MX4.*a2 + N21MX4.*S2;

    DG1MX4 = N13MX4;
    DG2MX4 = N23MX4;
    DG3MX4 = N33MX4;
    DG4MX4 = VP24;
    FDI41MY4 = C4.*U124 - S4.*U224;
    FDI43MY4 = C4.*U224 + S4.*U124;
    N31MY4 = -C4.*VSP24 - FDI43MY4.*d4;
    N32MY4 = -FDI43MY4.*a4 + VP14;
    N33MY4 = FDI41MY4.*d4 - S4.*VSP24 - U324.*a4;

    FDI32MY4 = -C3.*U324 + FDI41MY4.*S3;
    N21MY4 = C3.*N31MY4 - N32MY4.*S3;
    N22MY4 = C3.*N32MY4 - FDI43MY4.*a3 + N31MY4.*S3;
    N23MY4 = FDI32MY4.*a3 + N33MY4;

    N13MY4 = C2.*N22MY4 - FDI43MY4.*a2 + N21MY4.*S2;

    DG1MY4 = N13MY4;
    DG2MY4 = N23MY4;
    DG3MY4 = N33MY4;
    DG4MY4 = -VP14;

    DG4Im4 = ddq4;
    DG4FS4 = sign(dq4);
    DG4FV4 = dq4;
    N41XX5 = C5.*WP15 - DV35.*S5;
    N43XX5 = -C5.*DV35 - S5.*WP15;
    N31XX5 = C4.*N41XX5 + DV25.*S4;
    N33XX5 = -C4.*DV25 + N41XX5.*S4;
    N21XX5 = C3.*N31XX5 + N43XX5.*S3;
    N22XX5 = -C3.*N43XX5 + N31XX5.*S3;

    N13XX5 = C2.*N22XX5 + N21XX5.*S2;

    DG1XX5 = N13XX5;
    DG2XX5 = N33XX5;
    DG3XX5 = N33XX5;
    DG4XX5 = N43XX5;
    DG5XX5 = -DV25;
    No51XY5 = -W15.*W35 + WP25;
    No52XY5 = W25.*W35 + WP15;
    No53XY5 = W15.^2 - W25.^2;
    N41XY5 = C5.*No51XY5 - No52XY5.*S5;
    N43XY5 = -C5.*No52XY5 - No51XY5.*S5;
    N31XY5 = C4.*N41XY5 - No53XY5.*S4;
    N33XY5 = C4.*No53XY5 + N41XY5.*S4;
    N21XY5 = C3.*N31XY5 + N43XY5.*S3;
    N22XY5 = -C3.*N43XY5 + N31XY5.*S3;

    N13XY5 = C2.*N22XY5 + N21XY5.*S2;

    DG1XY5 = N13XY5;
    DG2XY5 = N33XY5;
    DG3XY5 = N33XY5;
    DG4XY5 = N43XY5;
    DG5XY5 = No53XY5;
    No51XZ5 = W15.*W25 + WP35;
    No52XZ5 = -W15.^2 + W35.^2;
    No53XZ5 = -W25.*W35 + WP15;
    N41XZ5 = C5.*No51XZ5 - No52XZ5.*S5;
    N43XZ5 = -C5.*No52XZ5 - No51XZ5.*S5;
    N31XZ5 = C4.*N41XZ5 - No53XZ5.*S4;
    N33XZ5 = C4.*No53XZ5 + N41XZ5.*S4;
    N21XZ5 = C3.*N31XZ5 + N43XZ5.*S3;
    N22XZ5 = -C3.*N43XZ5 + N31XZ5.*S3;

    N13XZ5 = C2.*N22XZ5 + N21XZ5.*S2;

    DG1XZ5 = N13XZ5;
    DG2XZ5 = N33XZ5;
    DG3XZ5 = N33XZ5;
    DG4XZ5 = N43XZ5;
    DG5XZ5 = No53XZ5;

    No51YZ5 = W25.^2 - W35.^2;
    No52YZ5 = -W15.*W25 + WP35;
    No53YZ5 = W15.*W35 + WP25;
    N41YZ5 = C5.*No51YZ5 - No52YZ5.*S5;
    N43YZ5 = -C5.*No52YZ5 - No51YZ5.*S5;
    N31YZ5 = C4.*N41YZ5 - No53YZ5.*S4;
    N33YZ5 = C4.*No53YZ5 + N41YZ5.*S4;
    N21YZ5 = C3.*N31YZ5 + N43YZ5.*S3;
    N22YZ5 = -C3.*N43YZ5 + N31YZ5.*S3;

    N13YZ5 = C2.*N22YZ5 + N21YZ5.*S2;

    DG1YZ5 = N13YZ5;
    DG2YZ5 = N33YZ5;
    DG3YZ5 = N33YZ5;
    DG4YZ5 = N43YZ5;
    DG5YZ5 = No53YZ5;
    N41ZZ5 = C5.*DV55 + DV35.*S5;
    N43ZZ5 = C5.*DV35 - DV55.*S5;
    N31ZZ5 = C4.*N41ZZ5 - S4.*WP35;
    N33ZZ5 = C4.*WP35 + N41ZZ5.*S4;
    N21ZZ5 = C3.*N31ZZ5 + N43ZZ5.*S3;
    N22ZZ5 = -C3.*N43ZZ5 + N31ZZ5.*S3;

    N13ZZ5 = C2.*N22ZZ5 + N21ZZ5.*S2;

    DG1ZZ5 = N13ZZ5;
    DG2ZZ5 = N33ZZ5;
    DG3ZZ5 = N33ZZ5;
    DG4ZZ5 = N43ZZ5;
    DG5ZZ5 = WP35;
    FDI51MX5 = C5.*U115 - S5.*U215;
    FDI53MX5 = -C5.*U215 - S5.*U115;
    N41MX5 = S5.*VP24;
    N43MX5 = C5.*VP24;
    FDI41MX5 = C4.*FDI51MX5 - S4.*U315;
    FDI43MX5 = C4.*U315 + FDI51MX5.*S4;
    N31MX5 = C4.*N41MX5 - FDI43MX5.*d4 - S4.*VP25;
    N32MX5 = -FDI43MX5.*a4 - N43MX5;
    N33MX5 = C4.*VP25 + FDI41MX5.*d4 - FDI53MX5.*a4 + N41MX5.*S4;

    FDI32MX5 = -C3.*FDI53MX5 + FDI41MX5.*S3;
    N21MX5 = C3.*N31MX5 - N32MX5.*S3;
    N22MX5 = C3.*N32MX5 - FDI43MX5.*a3 + N31MX5.*S3;
    N23MX5 = FDI32MX5.*a3 + N33MX5;

    N13MX5 = C2.*N22MX5 - FDI43MX5.*a2 + N21MX5.*S2;

    DG1MX5 = N13MX5;
    DG2MX5 = N23MX5;
    DG3MX5 = N33MX5;
    DG4MX5 = N43MX5;
    DG5MX5 = VP25;
    FDI51MY5 = C5.*U125 - S5.*U225;
    FDI53MY5 = -C5.*U225 - S5.*U125;
    FDI41MY5 = C4.*FDI51MY5 - S4.*U325;
    FDI43MY5 = C4.*U325 + FDI51MY5.*S4;
    N31MY5 = C4.*N43MX5 - FDI43MY5.*d4 + S4.*VP15;
    N32MY5 = -FDI43MY5.*a4 + N41MX5;
    N33MY5 = -C4.*VP15 + FDI41MY5.*d4 - FDI53MY5.*a4 + N43MX5.*S4;

    FDI32MY5 = -C3.*FDI53MY5 + FDI41MY5.*S3;
    N21MY5 = C3.*N31MY5 - N32MY5.*S3;
    N22MY5 = C3.*N32MY5 - FDI43MY5.*a3 + N31MY5.*S3;
    N23MY5 = FDI32MY5.*a3 + N33MY5;

    N13MY5 = C2.*N22MY5 - FDI43MY5.*a2 + N21MY5.*S2;

    DG1MY5 = N13MY5;
    DG2MY5 = N23MY5;
    DG3MY5 = N33MY5;
    DG4MY5 = -N41MX5;
    DG5MY5 = -VP15;

    DG5Im5 = ddq5;
    DG5FS5 = sign(dq5);
    DG5FV5 = dq5;
    N51XX6 = C6.*WP16 - DV36.*S6;
    N53XX6 = C6.*DV36 + S6.*WP16;
    N41XX6 = C5.*N51XX6 - DV26.*S5;
    N43XX6 = -C5.*DV26 - N51XX6.*S5;
    N31XX6 = C4.*N41XX6 - N53XX6.*S4;
    N33XX6 = C4.*N53XX6 + N41XX6.*S4;
    N21XX6 = C3.*N31XX6 + N43XX6.*S3;
    N22XX6 = -C3.*N43XX6 + N31XX6.*S3;

    N13XX6 = C2.*N22XX6 + N21XX6.*S2;

    DG1XX6 = N13XX6;
    DG2XX6 = N33XX6;
    DG3XX6 = N33XX6;
    DG4XX6 = N43XX6;
    DG5XX6 = N53XX6;
    DG6XX6 = -DV26;
    No61XY6 = -W16.*W36 + WP26;
    No62XY6 = W26.*W36 + WP16;
    No63XY6 = W16.^2 - W26.^2;
    N51XY6 = C6.*No61XY6 - No62XY6.*S6;
    N53XY6 = C6.*No62XY6 + No61XY6.*S6;
    N41XY6 = C5.*N51XY6 + No63XY6.*S5;
    N43XY6 = C5.*No63XY6 - N51XY6.*S5;
    N31XY6 = C4.*N41XY6 - N53XY6.*S4;
    N33XY6 = C4.*N53XY6 + N41XY6.*S4;
    N21XY6 = C3.*N31XY6 + N43XY6.*S3;
    N22XY6 = -C3.*N43XY6 + N31XY6.*S3;

    N13XY6 = C2.*N22XY6 + N21XY6.*S2;

    DG1XY6 = N13XY6;
    DG2XY6 = N33XY6;
    DG3XY6 = N33XY6;
    DG4XY6 = N43XY6;
    DG5XY6 = N53XY6;
    DG6XY6 = No63XY6;
    No61XZ6 = W16.*W26 + WP36;
    No62XZ6 = -W16.^2 + W36.^2;
    No63XZ6 = -W26.*W36 + WP16;
    N51XZ6 = C6.*No61XZ6 - No62XZ6.*S6;
    N53XZ6 = C6.*No62XZ6 + No61XZ6.*S6;
    N41XZ6 = C5.*N51XZ6 + No63XZ6.*S5;
    N43XZ6 = C5.*No63XZ6 - N51XZ6.*S5;
    N31XZ6 = C4.*N41XZ6 - N53XZ6.*S4;
    N33XZ6 = C4.*N53XZ6 + N41XZ6.*S4;
    N21XZ6 = C3.*N31XZ6 + N43XZ6.*S3;
    N22XZ6 = -C3.*N43XZ6 + N31XZ6.*S3;

    N13XZ6 = C2.*N22XZ6 + N21XZ6.*S2;

    DG1XZ6 = N13XZ6;
    DG2XZ6 = N33XZ6;
    DG3XZ6 = N33XZ6;
    DG4XZ6 = N43XZ6;
    DG5XZ6 = N53XZ6;
    DG6XZ6 = No63XZ6;

    No61YZ6 = W26.^2 - W36.^2;
    No62YZ6 = -W16.*W26 + WP36;
    No63YZ6 = W16.*W36 + WP26;
    N51YZ6 = C6.*No61YZ6 - No62YZ6.*S6;
    N53YZ6 = C6.*No62YZ6 + No61YZ6.*S6;
    N41YZ6 = C5.*N51YZ6 + No63YZ6.*S5;
    N43YZ6 = C5.*No63YZ6 - N51YZ6.*S5;
    N31YZ6 = C4.*N41YZ6 - N53YZ6.*S4;
    N33YZ6 = C4.*N53YZ6 + N41YZ6.*S4;
    N21YZ6 = C3.*N31YZ6 + N43YZ6.*S3;
    N22YZ6 = -C3.*N43YZ6 + N31YZ6.*S3;

    N13YZ6 = C2.*N22YZ6 + N21YZ6.*S2;

    DG1YZ6 = N13YZ6;
    DG2YZ6 = N33YZ6;
    DG3YZ6 = N33YZ6;
    DG4YZ6 = N43YZ6;
    DG5YZ6 = N53YZ6;
    DG6YZ6 = No63YZ6;
    N51ZZ6 = C6.*DV56 + DV36.*S6;
    N53ZZ6 = -C6.*DV36 + DV56.*S6;
    N41ZZ6 = C5.*N51ZZ6 + S5.*WP36;
    N43ZZ6 = C5.*WP36 - N51ZZ6.*S5;
    N31ZZ6 = C4.*N41ZZ6 - N53ZZ6.*S4;
    N33ZZ6 = C4.*N53ZZ6 + N41ZZ6.*S4;
    N21ZZ6 = C3.*N31ZZ6 + N43ZZ6.*S3;
    N22ZZ6 = -C3.*N43ZZ6 + N31ZZ6.*S3;

    N13ZZ6 = C2.*N22ZZ6 + N21ZZ6.*S2;

    DG1ZZ6 = N13ZZ6;
    DG2ZZ6 = N33ZZ6;
    DG3ZZ6 = N33ZZ6;
    DG4ZZ6 = N43ZZ6;
    DG5ZZ6 = N53ZZ6;
    DG6ZZ6 = WP36;
    FDI61MX6 = C6.*U116 - S6.*U216;
    FDI63MX6 = C6.*U216 + S6.*U116;
    N51MX6 = -FDI63MX6.*d6 - S6.*VSP26;
    N53MX6 = C6.*VSP26 + FDI61MX6.*d6;
    FDI51MX6 = C5.*FDI61MX6 + S5.*U316;
    FDI53MX6 = C5.*U316 - FDI61MX6.*S5;
    N41MX6 = C5.*N51MX6 + S5.*VP26;
    N43MX6 = C5.*VP26 - N51MX6.*S5;
    FDI41MX6 = C4.*FDI51MX6 - FDI63MX6.*S4;
    FDI43MX6 = C4.*FDI63MX6 + FDI51MX6.*S4;
    N31MX6 = C4.*N41MX6 - FDI43MX6.*d4 - N53MX6.*S4;
    N32MX6 = -FDI43MX6.*a4 - N43MX6;
    N33MX6 = C4.*N53MX6 + FDI41MX6.*d4 - FDI53MX6.*a4 + N41MX6.*S4;

    FDI32MX6 = -C3.*FDI53MX6 + FDI41MX6.*S3;
    N21MX6 = C3.*N31MX6 - N32MX6.*S3;
    N22MX6 = C3.*N32MX6 - FDI43MX6.*a3 + N31MX6.*S3;
    N23MX6 = FDI32MX6.*a3 + N33MX6;

    N13MX6 = C2.*N22MX6 - FDI43MX6.*a2 + N21MX6.*S2;

    DG1MX6 = N13MX6;
    DG2MX6 = N23MX6;
    DG3MX6 = N33MX6;
    DG4MX6 = N43MX6;
    DG5MX6 = N53MX6;
    DG6MX6 = VP26;
    FDI61MY6 = C6.*U126 - S6.*U226;
    FDI63MY6 = C6.*U226 + S6.*U126;
    N51MY6 = -C6.*VSP26 - FDI63MY6.*d6;
    N53MY6 = FDI61MY6.*d6 - S6.*VSP26;
    FDI51MY6 = C5.*FDI61MY6 + S5.*U326;
    FDI53MY6 = C5.*U326 - FDI61MY6.*S5;
    N41MY6 = C5.*N51MY6 - S5.*VP16;
    N43MY6 = -C5.*VP16 - N51MY6.*S5;
    FDI41MY6 = C4.*FDI51MY6 - FDI63MY6.*S4;
    FDI43MY6 = C4.*FDI63MY6 + FDI51MY6.*S4;
    N31MY6 = C4.*N41MY6 - FDI43MY6.*d4 - N53MY6.*S4;
    N32MY6 = -FDI43MY6.*a4 - N43MY6;
    N33MY6 = C4.*N53MY6 + FDI41MY6.*d4 - FDI53MY6.*a4 + N41MY6.*S4;

    FDI32MY6 = -C3.*FDI53MY6 + FDI41MY6.*S3;
    N21MY6 = C3.*N31MY6 - N32MY6.*S3;
    N22MY6 = C3.*N32MY6 - FDI43MY6.*a3 + N31MY6.*S3;
    N23MY6 = FDI32MY6.*a3 + N33MY6;

    N13MY6 = C2.*N22MY6 - FDI43MY6.*a2 + N21MY6.*S2;

    DG1MY6 = N13MY6;
    DG2MY6 = N23MY6;
    DG3MY6 = N33MY6;
    DG4MY6 = N43MY6;
    DG5MY6 = N53MY6;
    DG6MY6 = -VP16;

    DG6Im6 = ddq6;
    DG6FS6 = sign(dq6);
    DG6FV6 = dq6;